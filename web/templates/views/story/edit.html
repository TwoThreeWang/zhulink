{{ template "base.html" . }}

{{ define "scripts" }}
<!-- Marked.js -->
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script src="/static/js/editor.js"></script>
{{ end }}

{{ define "content" }}


<!-- Prose 样式组件 -->
{{ template "prose_styles" . }}

<!-- 双栏布局: 8:4 黄金比例 -->
<!-- 双栏布局: 8:4 黄金比例 -->
<div class="grid grid-cols-12 gap-12">

    <!-- 主内容区: col-span-8 -->
    <main class="col-span-12 lg:col-span-8">

        <!-- 页面标题 -->
        <header class="mb-8">
            <h1 class="font-sans font-bold text-2xl md:text-2xl text-ink leading-tight">编辑文章</h1>
            <p class="text-sm text-stone-500 mt-2">修改你的帖子内容。</p>
        </header>

        {{ if .Error }}
        <div class="bg-red-50 border border-red-200 text-red-700 p-4 rounded-lg mb-6 text-sm flex items-start">
            <i data-lucide="alert-circle" class="w-5 h-5 mr-3 flex-shrink-0 mt-0.5"></i>
            <span>{{ .Error }}</span>
        </div>
        {{ end }}

        <form action="/p/{{ .Post.Pid }}/edit" method="POST" class="space-y-5">

            <!-- 标题 -->
            <div class="flex flex-col md:flex-row md:items-center gap-2 md:gap-4">
                <label for="title" class="text-sm font-medium text-ink whitespace-nowrap w-8">标题 <span
                        class="text-red-500">*</span></label>
                <input type="text" id="title" name="title" value="{{ .Post.Title }}"
                    class="flex-grow bg-white border border-stone-200 rounded-lg px-4 py-2.5 text-base text-ink placeholder-stone-400 focus:outline-none focus:border-moss focus:ring-1 focus:ring-moss transition-colors"
                    placeholder="输入一个吸引人的标题" required autofocus>
            </div>

            <!-- 节点选择 -->
            <div class="flex flex-col md:flex-row md:items-center gap-2 md:gap-4">
                <label for="node_id" class="text-sm font-medium text-ink whitespace-nowrap w-8">节点 <span
                        class="text-red-500">*</span></label>
                <select id="node_id" name="node_id"
                    class="flex-grow md:max-w-xs appearance-none bg-white border border-stone-200 rounded-lg px-4 py-2.5 text-base text-ink focus:outline-none focus:border-moss focus:ring-1 focus:ring-moss transition-colors cursor-pointer">
                    {{ range .Nodes }}
                    <option value="{{ .ID }}" {{ if eq .ID $.Post.NodeID }}selected{{ end }}>{{ .Name }}</option>
                    {{ end }}
                </select>
            </div>

            <!-- 链接 (可选) -->
            <div class="flex flex-col md:flex-row md:items-center gap-2 md:gap-4">
                <label for="url" class="text-sm font-medium text-ink whitespace-nowrap w-8">链接</label>
                <input type="url" id="url" name="url" value="{{ .Post.URL }}"
                    class="flex-grow bg-white border border-stone-200 rounded-lg px-4 py-2.5 text-base text-ink placeholder-stone-400 focus:outline-none focus:border-moss focus:ring-1 focus:ring-moss transition-colors"
                    placeholder="https://example.com(可选)">
            </div>

            <!-- 内容编辑器 -->
            <div>
                <label class="block text-sm font-medium text-ink mb-2">内容 <span
                        class="text-stone-400 font-normal">(Markdown)</span></label>
                {{ template "markdown_editor" dict "Name" "content" "Value" .Post.Content "Placeholder" "支持 Markdown" }}
            </div>

            <!-- 提交按钮 -->
            <div class="flex items-center justify-between pt-4 border-t border-stone-100">
                <a href="/p/{{ .Post.Pid }}"
                    class="text-sm text-stone-500 hover:text-ink transition-colors inline-flex items-center">
                    <i data-lucide="arrow-left" class="w-4 h-4 mr-1"></i>
                    取消
                </a>

                <button type="submit"
                    class="inline-flex items-center justify-center min-w-[120px] px-6 py-2.5 bg-moss hover:bg-moss-dark text-white font-medium rounded-md shadow-sm transition-all hover:shadow focus:ring-2 focus:ring-offset-2 focus:ring-moss">
                    <i data-lucide="save" class="w-4 h-4 mr-2 flex-shrink-0"></i>
                    <span>保存修改</span>
                </button>
            </div>

        </form>

    </main>

    <!-- 侧边栏: col-span-4, sticky -->
    <aside class="hidden lg:block lg:col-span-4">
        <div class="sticky top-24 space-y-6">

            <!-- 编辑提示 -->
            <div class="bg-stone-50 rounded-lg p-5 border border-stone-100">
                <h3 class="font-bold text-ink mb-3 text-sm flex items-center">
                    <i data-lucide="edit-3" class="w-4 h-4 mr-2 text-moss"></i>
                    编辑提示
                </h3>
                <ul class="text-xs text-stone-600 space-y-2 leading-relaxed">
                    <li class="flex items-start">
                        <i data-lucide="info" class="w-3 h-3 mr-2 mt-0.5 text-stone-400 flex-shrink-0"></i>
                        <span>修改后原有的投票和评论将保留</span>
                    </li>
                    <li class="flex items-start">
                        <i data-lucide="info" class="w-3 h-3 mr-2 mt-0.5 text-stone-400 flex-shrink-0"></i>
                        <span>文章的发布时间不会改变</span>
                    </li>
                </ul>
            </div>

            <!-- Markdown 提示 -->
            <div class="bg-white rounded-lg p-5 border border-stone-100">
                <h3 class="font-bold text-ink mb-3 text-sm flex items-center">
                    <i data-lucide="file-text" class="w-4 h-4 mr-2 text-stone-400"></i>
                    Markdown 速查
                </h3>
                <div class="text-xs text-stone-600 space-y-1.5 font-mono">
                    <p><span class="text-moss">**粗体**</span> → <strong>粗体</strong></p>
                    <p><span class="text-moss">*斜体*</span> → <em>斜体</em></p>
                    <p><span class="text-moss">`代码`</span> → <code class="bg-stone-100 px-1 rounded text-xs">代码</code>
                    </p>
                    <p><span class="text-moss">[链接](url)</span> → <a href="#" class="text-moss">链接</a></p>
                    <p><span class="text-moss">> 引用</span> → 引用文字</p>
                </div>
            </div>

        </div>
    </aside>

</div>

{{ end }}