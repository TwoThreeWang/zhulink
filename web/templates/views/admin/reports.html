{{ template "base.html" . }}

{{ define "content" }}
<div class="max-w-5xl mx-auto py-8">
    <div class="flex flex-col md:flex-row gap-8 md:gap-12">
        <!-- 侧边栏 -->
        <aside class="md:w-48 flex-shrink-0">
            {{ template "dashboard_sidebar.html" dict "Active" "reports" "UnreadCount" 0 "CurrentUser" .CurrentUser }}
        </aside>

        <!-- 主内容区 -->
        <main class="flex-grow min-w-0">
            <div class="flex items-center justify-between mb-6 pl-1">
                <h1 class="text-xl font-bold text-ink">举报管理</h1>
            </div>

            {{ if .Reports }}
            <div class="space-y-4">
                {{ range .Reports }}
                <div id="report-{{ .ID }}"
                    class="relative pl-4 border-l-2 border-stone-200 bg-white rounded-r py-4 px-4 shadow-sm border border-stone-100 transition-all hover:bg-stone-50 group">
                    <div class="flex items-start justify-between gap-4">
                        <div class="flex-grow min-w-0">
                            <div class="text-sm text-stone-600 mb-2">
                                <span class="font-medium text-ink">{{ .User.Username }}</span>
                                <span class="text-stone-400 mx-1">举报了</span>
                                <span
                                    class="px-2 py-0.5 bg-stone-100 rounded text-xs text-stone-500 uppercase tracking-wider">{{
                                    .ItemType }}</span>
                                <span class="text-stone-400 mx-1">PID:</span>
                                <span class="font-mono text-xs text-moss bg-moss/5 px-1.5 py-0.5 rounded">{{ .ItemPid
                                    }}</span>
                            </div>

                            <div class="text-sm text-red-600 bg-red-50/50 p-3 rounded border border-red-100/50 mb-3">
                                <span class="font-bold mr-1">举报原因:</span> {{ .Reason }}
                            </div>

                            <div class="flex items-center gap-4">
                                {{ if eq .ItemType "post" }}
                                <a href="/p/{{ .ItemPid }}" target="_blank"
                                    class="text-xs text-moss hover:underline flex items-center gap-1">
                                    <i data-lucide="external-link" class="w-3 h-3"></i> 查看文章
                                </a>
                                {{ else }}
                                <a href="/p/{{ .ItemPid }}#comment-{{ .ItemID }}" target="_blank"
                                    class="text-xs text-moss hover:underline flex items-center gap-1">
                                    <i data-lucide="external-link" class="w-3 h-3"></i> 查看评论
                                </a>
                                {{ end }}
                                <span class="text-xs text-stone-300">{{ timeAgo .CreatedAt }}</span>
                            </div>
                        </div>

                        <!-- 操作 -->
                        <div class="flex-shrink-0">
                            <button hx-delete="/admin/reports/{{ .ID }}" hx-target="#report-{{ .ID }}"
                                hx-swap="outerHTML" hx-confirm="确定要忽略或已处理这条举报吗？"
                                class="p-2 text-stone-400 hover:text-moss hover:bg-moss/10 rounded-lg transition-all"
                                title="标记已处理">
                                <i data-lucide="check-circle" class="w-5 h-5"></i>
                            </button>
                        </div>
                    </div>
                </div>
                {{ end }}
            </div>
            {{ else }}
            <div class="py-12 text-center bg-stone-50/50 rounded-2xl border border-dashed border-stone-200">
                <div
                    class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-white shadow-sm mb-3 text-stone-300">
                    <i data-lucide="shield-check" class="w-6 h-6"></i>
                </div>
                <p class="text-stone-400 text-sm font-medium">天下太平</p>
                <p class="text-xs text-stone-300 mt-1">目前没有任何待处理的举报</p>
            </div>
            {{ end }}
        </main>
    </div>
</div>
{{ end }}